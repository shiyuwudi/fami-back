<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
    <script src="/lib/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <title>Welcome to Fami-Campaign-Page</title>
    <noscript>Please enable javascript first!</noscript>
</head>
<body>
<div id="app">
    <h1>Family Mart Coupon Page</h1>
    <hr/>
    <h3>Please scan the QR code below</h3>
    <div id="qrcode"></div>
    <p>{{ code }}</p>
    <p>{{ resp }}</p>
</div>
<script>
    var app =
        new Vue({
            el: '#app',
            data: {
                qr_code: '',
                code: '',
                resp: '',
            },
            mounted() {
                this.getCode();
            },
            methods: {
                getCode: async function () {
                    const q = this.getQueryString();
                    this.qs = JSON.stringify(q);
                    const resp = await axios.get('/qrcode');
                    this.resp = JSON.stringify(resp);
                },
                getQR () {
                    new QRCode(document.getElementById("qrcode"), this.qr_code);
                },
                // getQueryString() {
                //     var url = location.search; //获取url中"?"符后的字串
                //     var theRequest = new Object();
                //     if (url.indexOf("?") != -1) {
                //         var str = url.substr(1);
                //         strs = str.split("&");
                //         for (var i = 0; i < strs.length; i++) {
                //             theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
                //         }
                //     }
                //     return theRequest;
                // },
            },
        })
</script>
</body>
</html>
