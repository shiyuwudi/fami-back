<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
    <script src="/lib/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <title>Welcome to Fami-Campaign-Page</title>
    <noscript>Please enable javascript first!</noscript>
</head>
<body>
<div id="app">
    <h1>Family Mart Coupon Page</h1>
    <hr/>
    <h3>Please scan the QR code below</h3>
    <div id="qrcode"></div>
    <p>{{ code }}</p>
</div>
<script>
    var app =
        new Vue({
            el: '#app',
            data: {
                qr_code: '',
                code: '',
                resp: '',
            },
            mounted() {
                this.getCode();
            },
            methods: {
                getCode: async function () {
                    this.resp = 'getCode';
                    const resp = await axios.get('/qr');
                    const {
                        code,
                        qr_code,
                    } = resp.data.data;
                    this.code = code;
                    this.qr_code = qr_code;
                    this.genQR();
                },
                genQR () {
                    new QRCode(document.getElementById("qrcode"), this.qr_code);
                },
            },
        })
</script>
</body>
</html>
